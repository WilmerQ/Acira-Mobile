webpackJsonp([4],{669:function(n,l,o){"use strict";function i(n){return r._19(0,[(n()(),r.Z(0,0,null,null,9,"ion-col",[["class","col"],["col-auto",""],["no-margin",""],["no-padding",""]],null,null,null,null,null)),r.Y(1,16384,null,0,P.a,[],null,null),(n()(),r._18(-1,null,["\n        "])),(n()(),r.Z(3,0,null,null,5,"button",[["ion-fab",""],["large",""],["mini",""],["no-margin",""],["no-padding",""]],null,[[null,"click"]],function(n,l,o){var i=!0;if("click"===l){i=!1!==n.component.presentImage(r._11(n.parent,33))&&i}return i},k.b,k.a)),r.Y(4,49152,[[2,4]],0,z.a,[C.a,r.j,r.z],null,null),(n()(),r._18(-1,0,["\n          "])),(n()(),r.Z(6,0,null,0,1,"ion-icon",[["name","ios-image"],["role","img"]],[[2,"hide",null]],null,null,null,null)),r.Y(7,147456,null,0,H.a,[C.a,r.j,r.z],{name:[0,"name"]},null),(n()(),r._18(-1,0,["\n        "])),(n()(),r._18(-1,null,["\n      "]))],function(n,l){n(l,7,0,"ios-image")},function(n,l){n(l,6,0,r._11(l,7)._hidden)})}function t(n){return r._19(0,[(n()(),r.Z(0,0,null,null,5,"button",[["ion-fab",""],["large",""],["mini",""],["no-margin",""],["no-padding",""]],null,[[null,"click"]],function(n,l,o){var i=!0;if("click"===l){i=!1!==n.component.playAudio()&&i}return i},k.b,k.a)),r.Y(1,49152,[[2,4]],0,z.a,[C.a,r.j,r.z],null,null),(n()(),r._18(-1,0,["\n          "])),(n()(),r.Z(3,0,null,0,1,"ion-icon",[["name","ios-play"],["role","img"]],[[2,"hide",null]],null,null,null,null)),r.Y(4,147456,null,0,H.a,[C.a,r.j,r.z],{name:[0,"name"]},null),(n()(),r._18(-1,0,["\n        "]))],function(n,l){n(l,4,0,"ios-play")},function(n,l){n(l,3,0,r._11(l,4)._hidden)})}function a(n){return r._19(0,[(n()(),r.Z(0,0,null,null,5,"button",[["ion-fab",""],["large",""],["mini",""],["no-margin",""],["no-padding",""]],null,[[null,"click"]],function(n,l,o){var i=!0;if("click"===l){i=!1!==n.component.stopAudio()&&i}return i},k.b,k.a)),r.Y(1,49152,[[2,4]],0,z.a,[C.a,r.j,r.z],null,null),(n()(),r._18(-1,0,["\n          "])),(n()(),r.Z(3,0,null,0,1,"ion-icon",[["name","ios-pause"],["role","img"]],[[2,"hide",null]],null,null,null,null)),r.Y(4,147456,null,0,H.a,[C.a,r.j,r.z],{name:[0,"name"]},null),(n()(),r._18(-1,0,["\n        "]))],function(n,l){n(l,4,0,"ios-pause")},function(n,l){n(l,3,0,r._11(l,4)._hidden)})}function e(n){return r._19(0,[(n()(),r.Z(0,0,null,null,8,"ion-col",[["class","col"],["col-auto",""],["no-margin",""],["no-padding",""]],null,null,null,null,null)),r.Y(1,16384,null,0,P.a,[],null,null),(n()(),r._18(-1,null,["\n        "])),(n()(),r.U(16777216,null,null,1,null,t)),r.Y(4,16384,null,0,E.i,[r.I,r.F],{ngIf:[0,"ngIf"]},null),(n()(),r._18(-1,null,["\n        "])),(n()(),r.U(16777216,null,null,1,null,a)),r.Y(7,16384,null,0,E.i,[r.I,r.F],{ngIf:[0,"ngIf"]},null),(n()(),r._18(-1,null,["\n      "]))],function(n,l){var o=l.component;n(l,4,0,!o.reproduciendoAudio);n(l,7,0,o.reproduciendoAudio)},null)}function u(n){return r._19(0,[(n()(),r._18(-1,null,["\n"])),(n()(),r.Z(1,0,null,null,25,"ion-header",[],null,null,null,null,null)),r.Y(2,16384,null,0,O.a,[C.a,r.j,r.z,[2,S.a]],null,null),(n()(),r._18(-1,null,["\n  "])),(n()(),r.Z(4,0,null,null,21,"ion-navbar",[["class","toolbar"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,M.b,M.a)),r.Y(5,49152,null,0,V.a,[F.a,[2,S.a],[2,B.a],C.a,r.j,r.z],null,null),(n()(),r._18(-1,3,["\n    "])),(n()(),r.Z(7,0,null,3,5,"ion-title",[["mode","ios"]],null,[[null,"click"]],function(n,l,o){var i=!0;if("click"===l){i=!1!==n.component.informacion()&&i}return i},q.b,q.a)),r.Y(8,49152,null,0,T.a,[C.a,r.j,r.z,[2,U.a],[2,V.a]],{mode:[0,"mode"]},null),(n()(),r._18(-1,0,["\n      "])),(n()(),r.Z(10,0,null,0,1,"ion-icon",[["name","ios-information-circle-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),r.Y(11,147456,null,0,H.a,[C.a,r.j,r.z],{name:[0,"name"]},null),(n()(),r._18(-1,0,["\n      Información Aquí\n    "])),(n()(),r._18(-1,3,["\n    "])),(n()(),r.Z(14,0,null,2,10,"ion-buttons",[["right",""]],null,null,null,null,null)),r.Y(15,16384,null,1,W.a,[C.a,r.j,r.z,[2,U.a],[2,V.a]],null,null),r._16(603979776,1,{_buttons:1}),(n()(),r._18(-1,null,["\n      "])),(n()(),r.Z(18,0,null,null,5,"button",[["icon-only",""],["ion-button",""]],null,[[null,"click"]],function(n,l,o){var i=!0;if("click"===l){i=!1!==n.component.presentPopover(o)&&i}return i},X.b,X.a)),r.Y(19,1097728,[[1,4]],0,R.a,[[8,""],C.a,r.j,r.z],null,null),(n()(),r._18(-1,0,["\n        "])),(n()(),r.Z(21,0,null,0,1,"ion-icon",[["name","more"],["role","img"]],[[2,"hide",null]],null,null,null,null)),r.Y(22,147456,null,0,H.a,[C.a,r.j,r.z],{name:[0,"name"]},null),(n()(),r._18(-1,0,["\n      "])),(n()(),r._18(-1,null,["\n    "])),(n()(),r._18(-1,3,["\n  "])),(n()(),r._18(-1,null,["\n"])),(n()(),r._18(-1,null,["\n\n"])),(n()(),r.Z(28,0,null,null,33,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,N.b,N.a)),r.Y(29,4374528,null,0,K.a,[C.a,G.a,J.a,r.j,r.z,F.a,Q.a,r.u,[2,S.a],[2,B.a]],null,null),(n()(),r._18(-1,1,["\n  "])),(n()(),r.Z(31,0,null,1,0,"div",[["id","map"]],null,null,null,null,null)),(n()(),r._18(-1,1,["\n\n  "])),(n()(),r.Z(33,0,[["myImage",1]],1,0,"img",[],[[8,"src",4]],null,null,null,null)),(n()(),r._18(-1,1,["\n\n  "])),(n()(),r.Z(35,0,null,0,25,"ion-fab",[["bottom",""],["no-margin",""],["no-padding",""],["right",""]],null,null,null,$.b,$.a)),r.Y(36,1228800,null,2,nn.a,[G.a],null,null),r._16(603979776,2,{_mainButton:0}),r._16(603979776,3,{_fabLists:1}),(n()(),r._18(-1,0,["\n    "])),(n()(),r.Z(40,0,null,0,19,"ion-row",[["class","row"],["no-margin",""],["no-padding",""]],null,null,null,null,null)),r.Y(41,16384,null,0,ln.a,[],null,null),(n()(),r._18(-1,null,["\n      "])),(n()(),r.Z(43,0,null,null,9,"ion-col",[["class","col"],["col-auto",""],["no-margin",""],["no-padding",""]],null,null,null,null,null)),r.Y(44,16384,null,0,P.a,[],null,null),(n()(),r._18(-1,null,["\n        "])),(n()(),r.Z(46,0,null,null,5,"button",[["ion-fab",""],["large",""],["mini",""],["no-margin",""],["no-padding",""]],null,[[null,"click"]],function(n,l,o){var i=!0;if("click"===l){i=!1!==n.component.informacion()&&i}return i},k.b,k.a)),r.Y(47,49152,[[2,4]],0,z.a,[C.a,r.j,r.z],null,null),(n()(),r._18(-1,0,["\n          "])),(n()(),r.Z(49,0,null,0,1,"ion-icon",[["name","ios-information-circle-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),r.Y(50,147456,null,0,H.a,[C.a,r.j,r.z],{name:[0,"name"]},null),(n()(),r._18(-1,0,["\n        "])),(n()(),r._18(-1,null,["\n      "])),(n()(),r._18(-1,null,["\n      "])),(n()(),r.U(16777216,null,null,1,null,i)),r.Y(55,16384,null,0,E.i,[r.I,r.F],{ngIf:[0,"ngIf"]},null),(n()(),r._18(-1,null,["\n      "])),(n()(),r.U(16777216,null,null,1,null,e)),r.Y(58,16384,null,0,E.i,[r.I,r.F],{ngIf:[0,"ngIf"]},null),(n()(),r._18(-1,null,["\n    "])),(n()(),r._18(-1,0,["\n  "])),(n()(),r._18(-1,1,["\n"]))],function(n,l){var o=l.component;n(l,8,0,"ios");n(l,11,0,"ios-information-circle-outline");n(l,22,0,"more");n(l,50,0,"ios-information-circle-outline");n(l,55,0,o.buttonFabImagen);n(l,58,0,o.audioDisponible)},function(n,l){var o=l.component;n(l,4,0,r._11(l,5)._hidden,r._11(l,5)._sbPadding);n(l,10,0,r._11(l,11)._hidden);n(l,21,0,r._11(l,22)._hidden);n(l,28,0,r._11(l,29).statusbarPadding,r._11(l,29)._hasRefresher);n(l,33,0,o.urlImagen());n(l,49,0,r._11(l,50)._hidden)})}Object.defineProperty(l,"__esModule",{value:!0});var r=o(2),s=(o(0),o(31),o(168)),c=o(110),d=o(174),p=o(108),g=o(111),m=o(370),h=(o(372),o(171)),f=o(172),b=o(175),_=o(173),v=function(){function n(n,l,o,i,t,a,e,u,r,s,c,d,p){var g=this;this.navCtrl=n,this.navParams=l,this.geolocation=o,this.diagnostico=i,this.loadingController=t,this.popoverCtrl=a,this.transfer=e,this.file=u,this.media=r,this.platform=s,this.imageViewerCtrl=c,this.localstorage=d,this.alertCtrl=p,this.polylineExistente=!1,this.objetoHistorial=null,this.bounds=new google.maps.LatLngBounds,this.contador=1,this.rutaExistente=!1,this.directionsService=null,this.directionsDisplay=null,this.aux=!0,this.duracion="Solo disponible con ruta de automóvil habilitada",this.distancia="Solo disponible con ruta de automóvil habilitada",this.buttonFabImagen=!1,this.audioDisponible=!1,this.reproduciendoAudio=!1,this.changeLocationState=function(n){g.diagnostico.isLocationEnabled().then(function(n){n?(g.loading.dismiss(),g.polylineExistente=!1,g.aux=!0,g.rutaExistente=!1,g.contador=1,g.ionViewDidLoad()):(g.loading=g.loadingController.create({spinner:"ios",content:"Por favor encienda la ubicación en su dispositivo",dismissOnPageChange:!0}),g.loading.present())}).catch(function(n){return _.captureException(n)})},this.loading=this.loadingController.create({spinner:"ios",content:"Por favor encienda la ubicación en su dispositivo",dismissOnPageChange:!0}),this.objetoHistorial=l.get("objeto");var m=d.getObject("rutadirecta");this.rutaDirecta=m.indexOf("true")>=0,m=d.getObject("rutaauto"),this.rutaAuto=m.indexOf("true")>=0,this.directionsService=new google.maps.DirectionsService,this.directionsDisplay=new google.maps.DirectionsRenderer,this._imageViewerCtrl=c}return n.prototype.ionViewDidEnter=function(){var n=this;this.diagnostico.isLocationEnabled().then(function(l){l?(n.loading.dismiss(),n.ionViewDidLoad()):n.loading.present()}).catch(function(n){return _.captureException(n)}),this.diagnostico.registerLocationStateChangeHandler(this.changeLocationState)},n.prototype.ionViewDidLoad=function(){if(null!=this.objetoHistorial){null!=this.objetoHistorial.uuidImagen&&(this.buttonFabImagen=!0),null!=this.objetoHistorial.uuidAudio&&this.downloadAudio();this.loadMap(void 0)}},n.prototype.ionViewWillLeave=function(){this.rutaAuto=!1,this.rutaDirecta=!1},n.prototype.presentPopover=function(n){var l=this,o=this.popoverCtrl.create("PopoverPage",{tipo:"mapa"});o.onDidDismiss(function(){l.polylineExistente=!1,l.rutaExistente=!1,l.aux=!0;var n=l.localstorage.getObject("rutadirecta");l.rutaDirecta=n.indexOf("true")>=0,n=l.localstorage.getObject("rutaauto"),l.rutaAuto=n.indexOf("true")>=0,l.contador=1,l.ionViewDidLoad()}),o.present({ev:n})},n.prototype.loadMap=function(n){var l,o,i=this;void 0===n?(l=11.234722,o=-74.18995):(l=n.coords.latitude,o=n.coords.longitude);var t=document.getElementById("map"),a={lat:l,lng:o};this.map=new google.maps.Map(t,{center:a,zoom:17,mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.hybrid,myLocationButton:!0,streetViewControl:!1,zoomControl:!1,maxZoom:19});var e=new google.maps.Marker({map:this.map,icon:"assets/icon/bluecircle.png",title:"Tu ubicación actual"});google.maps.event.addListenerOnce(this.map,"idle",function(){i.geolocation.watchPosition({enableHighAccuracy:!0,maximumAge:0}).filter(function(n){return void 0!==n.coords}).subscribe(function(l){var o=new google.maps.LatLng(l.coords.latitude,l.coords.longitude);if(i.ubicacionActual=new google.maps.LatLng(l.coords.latitude,l.coords.longitude),e.setPosition(o),i.bounds.extend(o),i.bounds.extend(n.getPosition()),i.rutaDirecta||i.rutaAuto||!i.aux||(i.map.fitBounds(i.bounds),i.aux=!1),i.rutaDirecta){i.polylineExistente?i.polylineExistente&&i.flightPath.setMap(null):i.map.fitBounds(i.bounds);var t=[i.ubicacionActual,{lat:i.objetoHistorial.latitud,lng:i.objetoHistorial.longitud}];i.flightPath=new google.maps.Polyline({path:t,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2}),i.flightPath.setMap(i.map),i.polylineExistente=!0}i.rutaAuto&&(i.rutaExistente||i.map.fitBounds(i.bounds),800==i.contador||10==i.contador?(i.contador=11,i.directionsDisplay.setMap(i.map),i.directionsService.route({origin:new google.maps.LatLng(l.coords.latitude,l.coords.longitude),destination:new google.maps.LatLng(i.objetoHistorial.latitud,i.objetoHistorial.longitud),travelMode:google.maps.TravelMode.DRIVING,avoidTolls:!0},function(n,l){l===google.maps.DirectionsStatus.OK?(i.distancia=n.routes[0].legs[0].distance.text,i.duracion=n.routes[0].legs[0].duration.text,i.directionsDisplay.setDirections(n),i.rutaExistente=!0):alert("No se pudieron mostrar las indicaciones debido a: "+l)})):i.contador=i.contador+1)});var n=new google.maps.Marker({position:{lat:i.objetoHistorial.latitud,lng:i.objetoHistorial.longitud},map:i.map,icon:"assets/icon/cuidado.png",title:"Evento reportado aquí"}),l=new google.maps.InfoWindow({content:"Evento reportado aquí",position:{lat:i.objetoHistorial.latitud,lng:i.objetoHistorial.longitud}});n.addListener("click",function(){l.open(this.map)}),function(n,l){var o=new google.maps.InfoWindow({content:l});n.addListener("click",function(){o.open(n.get("map"),n)})}(e,e.title),t.classList.add("show-map")})},n.prototype.informacion=function(){this.alertCtrl.create({title:this.objetoHistorial.tipo,message:"Se recibe el reporte de "+this.objetoHistorial.tipo+". <br> Por: "+this.objetoHistorial.usuarioInformante+"<br> Fecha:"+this.objetoHistorial.fechaRecolecion+"<br>"+this.objetoHistorial.mensaje+"<br> Preste atención y tenga cuidado. <br><br><strong>-El punto azul en el mapa es su ubicacion actual.<br>-El circulo rojo es la zona donde se reporto el evento.<strong><br><br>-Duración:<strong> "+this.duracion+"<br>-Distancia:<strong> "+this.distancia,buttons:[{text:"OK",handler:function(){}}]}).present()},n.prototype.presentImage=function(n){this._imageViewerCtrl.create(n,{enableBackdropDismiss:!0}).present()},n.prototype.urlImagen=function(){var n="http://via.placeholder.com/150?text=code+trigger";return this.con=new m.a,null!=this.con&&null!=this.objetoHistorial&&(n=this.con.urlServletImagen+this.objetoHistorial.uuidImagen),n},n.prototype.downloadAudio=function(){var n=this,l=this.con.urlServletAudio+this.objetoHistorial.uuidAudio;this.transfer.create().download(l,this.file.dataDirectory+"voz.3gp").then(function(l){n.audioDisponible=!0},function(n){})},n.prototype.playAudio=function(){var n=this;this.platform.is("ios")?(this.filePath=this.file.dataDirectory+"voz.3gp",this.audio=this.media.create(this.filePath)):this.platform.is("android")&&(this.filePath=this.file.dataDirectory+"voz.3gp",this.audio=this.media.create(this.filePath)),this.audio.play(),this.audio.setVolume(.9),this.reproduciendoAudio=!0,this.audio.onStatusUpdate.subscribe(function(l){console.log("aqui en el status del audio "+l),4==l&&(n.reproduciendoAudio=!1)})},n.prototype.stopAudio=function(){this.audio.pause(),this.reproduciendoAudio=!1},n}(),j=function(){return function(){}}(),y=o(360),w=o(361),x=o(362),I=o(363),Z=o(364),D=o(365),Y=o(366),A=o(367),L=o(368),P=o(176),k=o(681),z=o(75),C=o(3),H=o(53),E=o(23),O=o(112),S=o(7),M=o(369),V=o(47),F=o(12),B=o(29),q=o(677),T=o(169),U=o(74),W=o(185),X=o(52),R=o(30),N=o(676),K=o(36),G=o(6),J=o(13),Q=o(51),$=o(682),nn=o(179),ln=o(177),on=o(15),tn=o(116),an=o(77),en=r.X({encapsulation:2,styles:[],data:{}}),un=r.V("page-maphistorial",v,function(n){return r._19(0,[(n()(),r.Z(0,0,null,null,1,"page-maphistorial",[],null,null,null,u,en)),r.Y(1,49152,null,0,v,[B.a,on.a,c.a,d.a,p.a,tn.a,h.a,f.a,b.a,G.a,an.a,s.a,g.a],null,null)],null,null)},{},{},[]),rn=o(26),sn=o(170),cn=o(54);o.d(l,"MaphistorialPageModuleNgFactory",function(){return dn});var dn=r.W(j,[],function(n){return r._7([r._8(512,r.i,r.S,[[8,[y.a,w.a,x.a,I.a,Z.a,D.a,Y.a,A.a,L.a,un]],[3,r.i],r.s]),r._8(4608,E.k,E.j,[r.r,[2,E.s]]),r._8(4608,rn.q,rn.q,[]),r._8(4608,rn.d,rn.d,[]),r._8(512,E.b,E.b,[]),r._8(512,rn.o,rn.o,[]),r._8(512,rn.g,rn.g,[]),r._8(512,rn.m,rn.m,[]),r._8(512,sn.a,sn.a,[]),r._8(512,sn.b,sn.b,[]),r._8(512,j,j,[]),r._8(256,cn.a,v,[])])})},676:function(n,l,o){"use strict";function i(n){return t._19(2,[t._16(402653184,1,{_fixedContent:0}),t._16(402653184,2,{_scrollContent:0}),(n()(),t.Z(2,0,[[1,0],["fixedContent",1]],null,1,"div",[["class","fixed-content"]],null,null,null,null,null)),t._10(null,0),(n()(),t.Z(4,0,[[2,0],["scrollContent",1]],null,1,"div",[["class","scroll-content"]],null,null,null,null,null)),t._10(null,1),t._10(null,2)],null,null)}o.d(l,"a",function(){return a}),l.b=i;var t=o(2),a=(o(3),o(6),o(13),o(51),o(7),o(29),t.X({encapsulation:2,styles:[],data:{}}))},677:function(n,l,o){"use strict";function i(n){return t._19(2,[(n()(),t.Z(0,0,null,null,2,"div",[["class","toolbar-title"]],null,null,null,null,null)),t.Y(1,278528,null,0,a.g,[t.p,t.q,t.j,t.A],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t._10(null,0)],function(n,l){n(l,1,0,"toolbar-title","toolbar-title-"+l.component._mode)},null)}o.d(l,"a",function(){return e}),l.b=i;var t=o(2),a=o(23),e=(o(3),t.X({encapsulation:2,styles:[],data:{}}))},681:function(n,l,o){"use strict";function i(n){return t._19(2,[(n()(),t.Z(0,0,null,null,1,"ion-icon",[["class","fab-close-icon"],["name","close"],["role","img"]],[[2,"hide",null]],null,null,null,null)),t.Y(1,147456,null,0,a.a,[e.a,t.j,t.z],{name:[0,"name"]},null),(n()(),t.Z(2,0,null,null,1,"span",[["class","button-inner"]],null,null,null,null,null)),t._10(null,0),(n()(),t.Z(4,0,null,null,0,"div",[["class","button-effect"]],null,null,null,null,null))],function(n,l){n(l,1,0,"close")},function(n,l){n(l,0,0,t._11(l,1)._hidden)})}o.d(l,"a",function(){return u}),l.b=i;var t=o(2),a=o(53),e=o(3),u=t.X({encapsulation:2,styles:[],data:{}})},682:function(n,l,o){"use strict";function i(n){return t._19(0,[t._10(null,0)],null,null)}o.d(l,"a",function(){return a}),l.b=i;var t=o(2),a=(o(6),t.X({encapsulation:2,styles:[],data:{}}))}});